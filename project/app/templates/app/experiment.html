{% extends 'base.html' %}


{% block content %}

{% for item in form %}
<img src="{{ item.img.url }}" class="product-image" alt='image'> 
{% endfor %}
<div class='form'>

<form method="POST">
  {% csrf_token %}
  <input  id='data' type='text' name='data' class='hidden'>
<button id='submit' class="btn btn-primary d-block mx-auto btn-lg hidden"> Send </button>
</form>


<div class="text-center">
  <input id='answer' type='text'>
  </div>
  
</div>

<div class="text-center d-grid">
<button id="next-button" class="btn btn-primary d-block mx-auto btn-lg"> Next </button>
</div>


{% endblock %}

{% block scripts %}
<script>
  const images = document.querySelectorAll('.product-image');
  const nextButton = document.getElementById('next-button');
  const subbutton = document.getElementById('submit');
  const data = document.getElementById('data');
  const ans = document.getElementById('answer');
  let currentIndex = 0;
      let labels = '';
    let ansver = '';


  function showImage(index) {
    images.forEach(image => image.style.display = 'none');
    images[index].style.display = 'block';
    {% comment %} setTimeout(() => {
      images[index].style.display = 'none';
    }, 5); {% endcomment %}
  }

  function nextImage() {
    if (currentIndex < images.length) {

      if (currentIndex === images.length -1){
        console.log('koniec listy');
        subbutton.classList.remove('hidden');


      } else{
        console.log('');
        
      };


      ansver = ans.value;


      if (ansver.length > 0){
        currentIndex++;
        labels += " " + ansver;
        ans.value='';
        console.log(labels, 'labelki');
        data.value = labels
        ans.focus();
        showImage(currentIndex);

      } else{
        console.log('cos poszlo nie tak');
      };
    
    };
  };

  nextButton.addEventListener('click', nextImage);
  showImage(currentIndex);
</script>
{% endblock %}